---
layout: 'n'
title: 并发编程-多线程之间通讯与线程池
date: 2019-06-17 09:46:17
categories: 并发编程
tags: [线程池,线程间通讯]
---

# wait与notify

## 抛出问题说明

 需求:第一个线程写入(input)用户，另一个线程取读取(out)用户.实现读一个，写一个操作。

先来看看反面例子一

``` java
class Res {
    public String userName;
    public String sex;
}

class InputThread extends Thread {
    private Res res;

    public InputThread(Res res) {
        this.res = res;
    }

    @Override
    public void run() {
        int count = 0;
        while (true) {
                if (count == 0) {
                    res.userName = "小李";
                    res.sex = "男";
                } else {
                    res.userName = "小红";
                    res.sex = "女";
                }
                count = (count + 1) % 2;  // 结果为0 1 0 1循环往复
        }
    }
}

class OutThrad extends Thread {
    private Res res;

    public OutThrad(Res res) {
        this.res = res;
    }

    @Override
    public void run() {
        while (true) {
            synchronized (res) {
                System.out.println(res.userName + "," + res.sex);
            }
        }

    }
}

public class ThreadDemo {

    public static void main(String[] args) {
        Res res = new Res();
        InputThread inputThread = new InputThread(res);
        OutThrad outThrad = new OutThrad(res);
        inputThread.start();
        outThrad.start();
    }

}
```

输出：

![1](1.png)

男女错位了，造成了线程安全问题