---
title: 原型模式
date: 2019-08-15 17:45:15
categories: [设计模式]
tags: [原型模式,深浅拷贝]
---

# 浅拷贝

``` java
public class Person implements Cloneable {
    private int age;
    private String name;
    private ArrayList<String> inter=new ArrayList<>();

    public int getAge() {
        return age;
    }

    public String getName() {
        return name;
    }

    public void getInter() {
        for (String inte:inter){
            System.out.println(inte);
        }
    }


    public void setAge(int age) {
        this.age = age;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setInter(String inter) {
        this.inter.add(inter);
    }

    @Override
    protected Person clone() {
           /*此种copy为浅copy,只能正确的copy基础类型，应用类型不可以copy，
           但是String因为是final修饰的，所以有这样与基础类型相似的效果
           其实是不可以copy的*/
        try {
            Person person = (Person) super.clone();
            return person;
        } catch (CloneNotSupportedException e) {
            e.printStackTrace();
        }
        /*try {
            Book book = (Book) super.clone();//
            book.image=(ArrayList<String>)this.image.clone();//深复制
            return book;
        } catch (CloneNotSupportedException e) {
            e.printStackTrace();
        }
        return null;*/
        return null;
    }

    public void show(){
        System.out.println("-----start-----");
        System.out.println("name:"+this.name);
        for (String inte:inter){
            System.out.println(inte);
        }
        System.out.println("age:"+this.age);
        System.out.println("-----end-----");
    }

}

```

``` java
public class QianCopy {

    public static void main(String[] args) {
        Person person = new Person();
        person.setAge(16);
        person.setName("ning");
        person.setInter("ball");
        person.show();
        System.out.println("==========================");
        Person person1=person.clone();
        person1.setInter("fly");
        person1.setName("guo");
        person1.setAge(17);
        person1.show();
    }

}
```

输出中可以看到List中属性有重复

``` java
// person
-----start-----
name:ning
ball
age:16
-----end-----
==========================
// person1
-----start-----
name:ning
ball
age:16
-----end-----
// person1
-----start-----
name:guo
ball
fly
age:17
-----end-----
// person
-----start-----
name:ning
ball
fly
age:16
-----end-----
```

# 深拷贝

​	与浅copy的区别在于

``` java
 @Override
    protected Person clone() {
        try {
            Person person = (Person) super.clone();
            // 为引用类型添加一个lone
            person.inter = (ArrayList<String>) this.inter.clone();
            return person;
        } catch (CloneNotSupportedException e) {
            e.printStackTrace();
        }
        return null;
    }
```



``` java
// person
-----start-----
name:ning
ball
age:16
-----end-----
==========================
// person1
-----start-----
name:ning
ball
age:16
-----end-----
// person1
-----start-----
name:guo
ball
fly
age:17
-----end-----
// person
-----start-----
name:ning
ball
age:16
-----end-----
```

